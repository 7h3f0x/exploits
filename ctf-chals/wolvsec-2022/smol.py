import angr
import claripy

proj = angr.Project('./smol')

flag_chars = [claripy.BVS('flag_%d' % i, 8) for i in range(32)]
flag = claripy.Concat(*flag_chars + [claripy.BVV(b'\n')])


# state = proj.factory.entry_state()

state = proj.factory.full_init_state(
    args=['./smol'],
    stdin=flag,
)

for k in flag_chars:
    state.solver.add(k > 0x20)
    state.solver.add(k <= 0x7f)

simgr = proj.factory.simulation_manager(state)
simgr.explore(find=lambda s: b"Congrats" in s.posix.dumps(1))
for s in simgr.found:
    print(s.posix.dumps(1))

    result = s.posix.dumps(0)
    print(result)
    # wsc{zEr0_1ns7rUcTi0n_S3t_fuTuR3}
